import{r as u,j as o}from"./index-CRqe24Pj.js";import{B as O}from"./BackButton-DJX8SMkP.js";function J(){const R=u.useRef(null),[T,b]=u.useState("menu"),[F,C]=u.useState(0),[k,N]=u.useState(()=>parseInt(localStorage.getItem("flappy_best")||"0")),B=u.useRef({});return u.useEffect(()=>{const s=R.current,e=s.getContext("2d");let i,r;function M(){i=s.width=window.innerWidth,r=s.height=window.innerHeight}M(),window.addEventListener("resize",M);let H;const l={x:0,y:0,vy:0,r:16};let y=[],v=[],f=0,S=parseInt(localStorage.getItem("flappy_best")||"0"),h=!1,p=!1,g=0;const w=160,c=60,G=3,z=-8,W=.4;let P=1,x=[];function I(){l.x=i*.2,l.y=r*.4,l.vy=0,y=[],v=[],f=0,g=0,P=1,x=[];for(let t=0;t<6;t++)v.push({x:Math.random()*i,y:Math.random()*r*.3,w:60+Math.random()*60,speed:.3+Math.random()*.5});C(0)}function _(){if(!(!h||p)){l.vy=z;for(let t=0;t<3;t++)x.push({x:l.x-10,y:l.y,vx:-Math.random()*2,vy:(Math.random()-.5)*3,life:1,color:"#ffd740"})}}function q(){const n=r-w-80,E=60+Math.random()*(n-60);y.push({x:i+10,topH:E,scored:!1})}function D(){l.vy+=W,l.y+=l.vy,l.y>r-50&&(l.y=r-50,L()),l.y<l.r&&(l.y=l.r,l.vy=0),g++,g>100&&(q(),g=0);for(let t=y.length-1;t>=0;t--){const n=y[t];if(n.x-=G+f*.05,n.x+c<0){y.splice(t,1);continue}l.x+l.r>n.x&&l.x-l.r<n.x+c&&(l.y-l.r<n.topH||l.y+l.r>n.topH+w)&&L(),!n.scored&&n.x+c<l.x&&(n.scored=!0,f++,C(f),f>S&&(S=f,localStorage.setItem("flappy_best",S),N(S)))}P=Math.max(.15,1-f*.02),v.forEach(t=>{t.x-=t.speed,t.x+t.w<0&&(t.x=i+20,t.y=Math.random()*r*.3)});for(let t=x.length-1;t>=0;t--){const n=x[t];n.x+=n.vx,n.y+=n.vy,n.life-=.04,n.life<=0&&x.splice(t,1)}}function L(){p=!0,h=!1,b("over")}function K(){const t=P,n=e.createLinearGradient(0,0,0,r);if(n.addColorStop(0,`rgb(${Math.round(30+100*t)},${Math.round(60+140*t)},${Math.round(100+155*t)})`),n.addColorStop(1,`rgb(${Math.round(10+180*t)},${Math.round(20+190*t)},${Math.round(40+160*t)})`),e.fillStyle=n,e.fillRect(0,0,i,r),t<.5){e.fillStyle=`rgba(255,255,255,${.8-t})`;for(let a=0;a<30;a++){const d=a*137%i,m=a*97%(r*.5);e.fillRect(d,m,2,2)}}e.fillStyle=`rgba(255,255,255,${.15+.15*t})`,v.forEach(a=>{e.beginPath(),e.arc(a.x,a.y,a.w*.3,0,Math.PI*2),e.arc(a.x+a.w*.3,a.y-8,a.w*.25,0,Math.PI*2),e.arc(a.x+a.w*.5,a.y,a.w*.2,0,Math.PI*2),e.fill()}),e.fillStyle="#3a6a3a",e.fillRect(0,r-50,i,50),e.fillStyle="#4a8a4a",e.fillRect(0,r-50,i,5),y.forEach(a=>{const d=e.createLinearGradient(a.x,0,a.x+c,0);d.addColorStop(0,"#4caf50"),d.addColorStop(.5,"#66bb6a"),d.addColorStop(1,"#388e3c"),e.fillStyle=d,e.fillRect(a.x,0,c,a.topH),e.fillRect(a.x-5,a.topH-20,c+10,20);const m=a.topH+w;e.fillRect(a.x,m,c,r-m),e.fillRect(a.x-5,m,c+10,20)});const E=Math.min(l.vy*3,60)*Math.PI/180;e.save(),e.translate(l.x,l.y),e.rotate(E),e.fillStyle="#ffd740",e.beginPath(),e.arc(0,0,l.r,0,Math.PI*2),e.fill(),e.fillStyle="#ffab00",e.beginPath(),e.ellipse(-6,4,10,6,-.3,0,Math.PI*2),e.fill(),e.fillStyle="#fff",e.beginPath(),e.arc(8,-5,5,0,Math.PI*2),e.fill(),e.fillStyle="#000",e.beginPath(),e.arc(9,-5,2.5,0,Math.PI*2),e.fill(),e.fillStyle="#ff5722",e.beginPath(),e.moveTo(14,0),e.lineTo(22,2),e.lineTo(14,5),e.fill(),e.restore(),x.forEach(a=>{const d=Math.round(a.life*255).toString(16).padStart(2,"0");e.fillStyle=a.color+d,e.beginPath(),e.arc(a.x,a.y,3*a.life,0,Math.PI*2),e.fill()}),h&&!p&&(e.fillStyle="#fff",e.font="bold 48px sans-serif",e.textAlign="center",e.fillText(f,i/2,80))}function $(){h&&!p&&D(),K(),H=requestAnimationFrame($)}const j=()=>{p||(h||(h=!0,p=!1,I(),b("playing")),_())},A=t=>{(t.code==="Space"||t.code==="ArrowUp")&&(t.preventDefault(),j())};return window.addEventListener("keydown",A),s.addEventListener("click",j),B.current.restart=()=>{p=!1,h=!1,I(),b("menu")},I(),$(),()=>{cancelAnimationFrame(H),window.removeEventListener("keydown",A),window.removeEventListener("resize",M),s.removeEventListener("click",j)}},[]),o.jsxs("div",{className:"fb-root",children:[o.jsx("canvas",{ref:R,className:"fb-canvas"}),T==="menu"&&o.jsxs("div",{className:"fb-overlay",children:[o.jsx("h1",{children:"ðŸ¦ Flappy Bird"}),o.jsx("p",{children:"Click or press SPACE to flap"}),o.jsxs("p",{className:"fb-best",children:["Best: ",k]})]}),T==="over"&&o.jsxs("div",{className:"fb-gameover",children:[o.jsx("h2",{children:"Game Over"}),o.jsxs("p",{children:["Score: ",F]}),o.jsxs("p",{children:["Best: ",k]}),o.jsx("button",{onClick:()=>{var s,e;return(e=(s=B.current).restart)==null?void 0:e.call(s)},children:"Try Again"})]}),o.jsx(O,{})]})}export{J as default};
