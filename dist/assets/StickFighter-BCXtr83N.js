import{r as f,j as n}from"./index-DxoVmnoF.js";import{B as V}from"./BackButton-rhTEpRQT.js";function X(){const L=f.useRef(null),[b,P]=f.useState("menu"),[R,y]=f.useState(0),[W,H]=f.useState(100),[O,A]=f.useState(100),[S,C]=f.useState(1),[F,j]=f.useState(0),I=f.useRef({});return f.useEffect(()=>{const m=L.current,e=m.getContext("2d");let d,h;function M(){d=m.width=window.innerWidth,h=m.height=window.innerHeight}M(),window.addEventListener("resize",M);let B;const D=.8;let v,p=0,r=1,c=0,N=0,x=!1,g=!1;const T=[],t={x:200,y:0,vx:0,vy:0,speed:5,jumping:!1,hp:100,attacking:!1,atkType:"",atkCd:0,dir:1},a={x:0,y:0,vx:0,vy:0,speed:3,hp:100,attacking:!1,atkCd:0,aiT:0,dir:-1},k={a:!1,d:!1,w:!1,j:!1,k:!1};function w(){v=h-70,t.x=200,t.y=v,t.hp=100,t.vx=0,t.vy=0,t.attacking=!1,t.atkCd=0,a.x=d-300,a.y=v,a.hp=100+(r-1)*20,a.speed=3+r*.3,a.vx=0,a.vy=0,a.attacking=!1,a.atkCd=0,a.aiT=0,H(t.hp),A(a.hp)}function K(i,s,o,l=6){for(let u=0;u<l;u++)T.push({x:i,y:s,vx:(Math.random()-.5)*6,vy:(Math.random()-.5)*6,life:1,color:o})}function $(i,s,o,l,u,E){e.strokeStyle=o,e.lineWidth=3,e.lineCap="round",e.beginPath(),e.arc(i,s-60,12,0,Math.PI*2),e.stroke(),e.beginPath(),e.moveTo(i,s-48),e.lineTo(i,s-20),e.stroke(),u&&E==="punch"?(e.beginPath(),e.moveTo(i,s-40),e.lineTo(i+l*30,s-35),e.stroke(),e.beginPath(),e.moveTo(i,s-40),e.lineTo(i-l*10,s-30),e.stroke(),e.fillStyle="#ffd740",e.beginPath(),e.arc(i+l*33,s-35,6,0,Math.PI*2),e.fill()):u&&E==="kick"?(e.beginPath(),e.moveTo(i,s-40),e.lineTo(i-10,s-30),e.stroke(),e.beginPath(),e.moveTo(i,s-40),e.lineTo(i+10,s-30),e.stroke(),e.beginPath(),e.moveTo(i,s-20),e.lineTo(i+l*35,s-10),e.stroke(),e.fillStyle="#ff5252",e.beginPath(),e.arc(i+l*38,s-10,6,0,Math.PI*2),e.fill()):(e.beginPath(),e.moveTo(i,s-40),e.lineTo(i-10,s-30),e.stroke(),e.beginPath(),e.moveTo(i,s-40),e.lineTo(i+10,s-30),e.stroke()),u&&E==="kick"||(e.beginPath(),e.moveTo(i,s-20),e.lineTo(i-10,s),e.stroke(),e.beginPath(),e.moveTo(i,s-20),e.lineTo(i+10,s),e.stroke())}function q(){if(v=h-70,k.a?(t.vx=-5,t.dir=-1):k.d?(t.vx=t.speed,t.dir=1):t.vx=0,k.w&&!t.jumping&&(t.vy=-15,t.jumping=!0),t.vy+=D,t.x+=t.vx,t.y+=t.vy,t.y>=v&&(t.y=v,t.vy=0,t.jumping=!1),t.x=Math.max(50,Math.min(d-50,t.x)),t.atkCd>0&&t.atkCd--,t.attacking){const s=t.atkType==="kick"?50:35;if(Math.abs(t.x-a.x)<s&&Math.abs(t.y-a.y)<50){const l=(t.atkType==="kick"?15:10)+c*2;a.hp-=l,p+=l,c++,N=60,j(c),y(p),A(Math.max(0,a.hp)),K(a.x,a.y-30,t.atkType==="kick"?"#ff5252":"#ffd740")}setTimeout(()=>{t.attacking=!1},150)}a.aiT++;const i=t.x-a.x;a.aiT>40&&(Math.abs(i)>70?(a.vx=i>0?a.speed:-a.speed,a.dir=i>0?1:-1):(a.vx=0,Math.random()<.06+r*.005&&!a.attacking&&a.atkCd<=0&&(a.attacking=!0,a.atkCd=35-Math.min(15,r*2),Math.abs(i)<45&&Math.abs(t.y-a.y)<50&&(t.hp-=10+r,H(Math.max(0,t.hp)),K(t.x,t.y-30,"#00e5ff")),setTimeout(()=>{a.attacking=!1},150)))),a.vy+=D,a.x+=a.vx,a.y+=a.vy,a.y>=v&&(a.y=v,a.vy=0),a.x=Math.max(50,Math.min(d-50,a.x)),a.atkCd>0&&a.atkCd--,N>0?N--:(c=0,j(0)),a.hp<=0&&(p+=100*r,y(p),r++,C(r),w()),t.hp<=0&&(g=!0,x=!1,P("over"))}function U(){const i=e.createLinearGradient(0,0,0,h);i.addColorStop(0,"#1a1a3e"),i.addColorStop(1,"#0a0e1a"),e.fillStyle=i,e.fillRect(0,0,d,h),e.fillStyle="#1a2a1a",e.fillRect(0,h-70,d,70),e.fillStyle="#2a4a2a",e.fillRect(0,h-70,d,4);for(let s=T.length-1;s>=0;s--){const o=T[s];if(o.x+=o.vx,o.y+=o.vy,o.life-=.03,o.life<=0){T.splice(s,1);continue}e.fillStyle=o.color+Math.round(o.life*255).toString(16).padStart(2,"0"),e.beginPath(),e.arc(o.x,o.y,4*o.life,0,Math.PI*2),e.fill()}$(t.x,t.y,"#00e5ff",t.dir,t.attacking,t.atkType),$(a.x,a.y,"#ff5252",a.dir,a.attacking,"punch"),c>1&&(e.save(),e.font=`bold ${24+c*2}px sans-serif`,e.fillStyle="#ffd740",e.textAlign="center",e.fillText(`${c}x COMBO!`,d/2,h/2-40),e.restore())}function z(){x&&!g&&q(),U(),B=requestAnimationFrame(z)}const G=i=>{const s=i.key.toLowerCase();i.code==="Space"&&!x&&!g&&(x=!0,g=!1,p=0,r=1,c=0,y(0),C(1),j(0),w(),P("playing")),s in k&&(k[s]=!0),s==="j"&&!t.attacking&&t.atkCd<=0&&(t.attacking=!0,t.atkType="punch",t.atkCd=25),s==="k"&&!t.attacking&&t.atkCd<=0&&(t.attacking=!0,t.atkType="kick",t.atkCd=35)},J=i=>{const s=i.key.toLowerCase();s in k&&(k[s]=!1)};return window.addEventListener("keydown",G),window.addEventListener("keyup",J),I.current.restart=()=>{g=!1,x=!1,p=0,r=1,c=0,y(0),C(1),j(0),w(),P("menu")},w(),z(),()=>{cancelAnimationFrame(B),window.removeEventListener("keydown",G),window.removeEventListener("keyup",J),window.removeEventListener("resize",M)}},[]),n.jsxs("div",{className:"sf-root",children:[n.jsx("canvas",{ref:L,className:"sf-canvas"}),b==="menu"&&n.jsxs("div",{className:"sf-overlay",children:[n.jsx("h1",{children:"ðŸ¥Š Stickman Fighter"}),n.jsxs("div",{className:"sf-keys",children:[n.jsx("p",{children:"A/D - Move Â  W - Jump"}),n.jsx("p",{children:"J - Punch Â  K - Kick"})]}),n.jsx("p",{children:"Press SPACE to start"})]}),b==="playing"&&n.jsxs("div",{className:"sf-hud",children:[n.jsxs("div",{className:"sf-bar-wrap",children:[n.jsx("span",{children:"Player"}),n.jsx("div",{className:"sf-bar",children:n.jsx("div",{className:"sf-fill cyan",style:{width:`${W}%`}})})]}),n.jsxs("div",{className:"sf-info",children:[n.jsxs("div",{children:["Score: ",R]}),n.jsxs("div",{children:["Wave: ",S]}),F>1&&n.jsxs("div",{className:"sf-combo",children:[F,"x"]})]}),n.jsxs("div",{className:"sf-bar-wrap",children:[n.jsx("span",{children:"Enemy"}),n.jsx("div",{className:"sf-bar",children:n.jsx("div",{className:"sf-fill red",style:{width:`${Math.max(0,O/(100+(S-1)*20)*100)}%`}})})]})]}),b==="over"&&n.jsxs("div",{className:"sf-gameover",children:[n.jsx("h2",{children:W<=0?"Defeated!":"Victory!"}),n.jsxs("p",{children:["Score: ",R]}),n.jsxs("p",{children:["Waves survived: ",S-1]}),n.jsx("button",{onClick:()=>{var m,e;return(e=(m=I.current).restart)==null?void 0:e.call(m)},children:"Restart"})]}),n.jsx(V,{})]})}export{X as default};
