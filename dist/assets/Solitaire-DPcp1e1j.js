import{r as i,j as n}from"./index-DxoVmnoF.js";import{B as A}from"./BackButton-rhTEpRQT.js";const K=["â™ ","â™¥","â™¦","â™£"],G={"â™ ":"#e0e0e0","â™¥":"#ff5252","â™¦":"#ff5252","â™£":"#e0e0e0"},B=["A","2","3","4","5","6","7","8","9","10","J","Q","K"];function J(){const r=[];for(const u of K)for(const d of B)r.push({rank:d,suit:u,faceUp:!1,id:`${d}${u}`});for(let u=r.length-1;u>0;u--){const d=Math.floor(Math.random()*(u+1));[r[u],r[d]]=[r[d],r[u]]}return r}function g(r){return B.indexOf(r)}function E(r){return r==="â™¥"||r==="â™¦"}function V(){const[r,u]=i.useState(!1),[d,N]=i.useState([[],[],[],[],[],[],[]]),[h,j]=i.useState([[],[],[],[]]),[S,b]=i.useState([]),[m,k]=i.useState([]),[o,f]=i.useState(null),[$,v]=i.useState(0),[I,y]=i.useState(!1),[F,M]=i.useState(0),p=i.useRef(null),w=i.useCallback(()=>{const e=J(),s=[[],[],[],[],[],[],[]];let t=0;for(let a=0;a<7;a++)for(let c=0;c<=a;c++){const x={...e[t++],faceUp:c===a};s[a].push(x)}const l=e.slice(t).map(a=>({...a,faceUp:!1}));N(s),j([[],[],[],[]]),b(l),k([]),f(null),v(0),y(!1),u(!0),M(0),p.current&&clearInterval(p.current),p.current=setInterval(()=>M(a=>a+1),1e3)},[]);i.useEffect(()=>()=>{p.current&&clearInterval(p.current)},[]),i.useEffect(()=>{h.every(e=>e.length===13)&&r&&(y(!0),p.current&&clearInterval(p.current))},[h,r]);const D=()=>{if(S.length===0)b(m.map(e=>({...e,faceUp:!1})).reverse()),k([]);else{const e=[...S],s={...e.pop(),faceUp:!0};b(e),k(t=>[...t,s])}f(null)},R=(e,s)=>{const t=h[s];if(t.length===0)return e.rank==="A";const l=t[t.length-1];return l.suit===e.suit&&g(e.rank)===g(l.rank)+1},P=(e,s)=>{const t=d[s];if(t.length===0)return e.rank==="K";const l=t[t.length-1];return E(e.suit)!==E(l.suit)&&g(e.rank)===g(l.rank)-1},C=(e,s,t)=>{if(!I){if(o&&o.source===e&&o.colIdx===s&&o.cardIdx===t){f(null);return}if(o){let l=[];if(o.source==="waste"?l=[m[m.length-1]]:o.source==="tableau"?l=d[o.colIdx].slice(o.cardIdx):o.source==="foundation"&&(l=[h[o.colIdx][h[o.colIdx].length-1]]),l.length===0){f(null);return}if(e==="foundation"&&l.length===1&&R(l[0],s)){const a=h.map(c=>[...c]);a[s]=[...a[s],l[0]],T(o),j(a),v(c=>c+1),f(null);return}if(e==="tableau"&&P(l[0],s)){const a=d.map(c=>[...c]);a[s]=[...a[s],...l],T(o),N(a),v(c=>c+1),f(null);return}f(e==="waste"||e==="tableau"?{source:e,colIdx:s,cardIdx:t}:null)}else f({source:e,colIdx:s,cardIdx:t})}},T=e=>{e.source==="waste"?k(s=>{const t=[...s];return t.pop(),t}):e.source==="tableau"?N(s=>{const t=s.map(l=>[...l]);return t[e.colIdx]=t[e.colIdx].slice(0,e.cardIdx),t[e.colIdx].length>0&&(t[e.colIdx][t[e.colIdx].length-1].faceUp=!0),t}):e.source==="foundation"&&j(s=>{const t=s.map(l=>[...l]);return t[e.colIdx]=t[e.colIdx].slice(0,-1),t})},W=(e,s,t,l)=>{for(let a=0;a<4;a++)if(R(e,a)){const c=h.map(x=>[...x]);return c[a]=[...c[a],e],T({source:s,colIdx:t,cardIdx:l}),j(c),v(x=>x+1),f(null),!0}return!1},O=e=>`${Math.floor(e/60)}:${(e%60).toString().padStart(2,"0")}`,z=(e,s,t)=>o&&o.source===e&&o.colIdx===s&&o.cardIdx===t,U=(e,s,t,l,a={})=>{if(!e.faceUp)return n.jsx("div",{className:"sol-card facedown",style:a,children:n.jsx("div",{className:"sol-card-back",children:"â™¾"})},`${t}-${l}`);const c=z(s,t,l);return n.jsxs("div",{className:`sol-card faceup ${c?"selected":""}`,style:{...a,color:G[e.suit]},onClick:()=>C(s,t,l),onDoubleClick:()=>W(e,s,t,l),children:[n.jsx("span",{className:"sol-rank",children:e.rank}),n.jsx("span",{className:"sol-suit",children:e.suit})]},e.id)};return r?n.jsxs("div",{className:"sol-root",children:[n.jsxs("div",{className:"sol-top-bar",children:[n.jsxs("div",{className:"sol-stats",children:["Moves: ",$," Â Â  Time: ",O(F)]}),n.jsx("button",{className:"sol-new",onClick:w,children:"New Game"})]}),n.jsxs("div",{className:"sol-upper",children:[n.jsxs("div",{className:"sol-stock-waste",children:[n.jsx("div",{className:"sol-stock",onClick:D,children:S.length>0?n.jsx("div",{className:"sol-card facedown",children:n.jsx("div",{className:"sol-card-back",children:"â™¾"})}):n.jsx("div",{className:"sol-empty",children:"â†º"})}),n.jsx("div",{className:"sol-waste-pile",children:m.length>0&&U(m[m.length-1],"waste",0,m.length-1)})]}),n.jsx("div",{className:"sol-foundations",children:h.map((e,s)=>n.jsx("div",{className:"sol-foundation",onClick:()=>o&&C("foundation",s,0),children:e.length>0?U(e[e.length-1],"foundation",s,e.length-1):n.jsx("div",{className:"sol-empty",children:K[s]})},s))})]}),n.jsx("div",{className:"sol-tableau",children:d.map((e,s)=>n.jsxs("div",{className:"sol-column",onClick:()=>e.length===0&&o&&C("tableau",s,0),children:[e.length===0&&n.jsx("div",{className:"sol-empty",children:"â€”"}),e.map((t,l)=>U(t,"tableau",s,l,{top:`${l*28}px`,position:"absolute",zIndex:l})),n.jsx("div",{style:{height:e.length*28+80}})]},s))}),I&&n.jsxs("div",{className:"sol-win",children:[n.jsx("h2",{children:"ğŸ‰ You Win!"}),n.jsxs("p",{children:["Moves: ",$," Â  Time: ",O(F)]}),n.jsx("button",{onClick:w,children:"Play Again"})]}),n.jsx(A,{})]}):n.jsxs("div",{className:"sol-menu",children:[n.jsx("h1",{children:"ğŸƒ Solitaire"}),n.jsx("p",{children:"Klondike"}),n.jsx("button",{onClick:w,children:"Deal Cards"}),n.jsx(A,{})]})}export{V as default};
