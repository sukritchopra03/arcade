import{r as I,j as r}from"./index-CRqe24Pj.js";import{B as O}from"./BackButton-DJX8SMkP.js";const a=8,C=0,t=1,i=2,P=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,1],[1,-1],[1,0],[1,1]];function F(){const s=Array.from({length:a},()=>Array(a).fill(C));return s[3][3]=i,s[3][4]=t,s[4][3]=t,s[4][4]=i,s}function E(s,c,o,e){if(s[c][o]!==C)return[];const n=e===t?i:t,d=[];for(const[k,m]of P){const w=[];let h=c+k,f=o+m;for(;h>=0&&h<a&&f>=0&&f<a&&s[h][f]===n;)w.push([h,f]),h+=k,f+=m;w.length>0&&h>=0&&h<a&&f>=0&&f<a&&s[h][f]===e&&d.push(...w)}return d}function N(s,c){const o=[];for(let e=0;e<a;e++)for(let n=0;n<a;n++)E(s,e,n,c).length>0&&o.push([e,n]);return o}function Y(s){let c=0,o=0;for(const e of s)for(const n of e)n===t&&c++,n===i&&o++;return{b:c,w:o}}const D=[[100,-20,10,5,5,10,-20,100],[-20,-50,-2,-2,-2,-2,-50,-20],[10,-2,1,1,1,1,-2,10],[5,-2,1,0,0,1,-2,5],[5,-2,1,0,0,1,-2,5],[10,-2,1,1,1,1,-2,10],[-20,-50,-2,-2,-2,-2,-50,-20],[100,-20,10,5,5,10,-20,100]];function H(s){const c=N(s,i);if(!c.length)return null;let o=null,e=-1/0;for(const[n,d]of c){const m=E(s,n,d,i).length*2+D[n][d];m>e&&(e=m,o=[n,d])}return o}function Z(){const[s,c]=I.useState(F),[o,e]=I.useState(t),[n,d]=I.useState(!1),[k,m]=I.useState([]),w=I.useCallback((x,p,v)=>{const j=E(s,x,p,v);if(!j.length)return!1;const l=s.map(u=>[...u]);l[x][p]=v;for(const[u,b]of j)l[u][b]=v;c(l),m(j.map(([u,b])=>u*a+b));const g=v===t?i:t,T=N(l,g),$=N(l,v);return T.length>0?(e(g),g===i&&setTimeout(()=>{const u=H(l);if(u){const b=E(l,u[0],u[1],i),S=l.map(B=>[...B]);S[u[0]][u[1]]=i;for(const[B,W]of b)S[B][W]=i;c(S),m(b.map(([B,W])=>B*a+W)),N(S,t).length>0?e(t):N(S,i).length>0?e(i):d(!0)}},400)):$.length>0?e(v):d(!0),!0},[s]),h=(x,p)=>{n||o!==t||w(x,p,t)},f=()=>{c(F()),e(t),d(!1),m([])},{b:M,w:A}=Y(s),G=o===t?N(s,t):[],R=new Set(G.map(([x,p])=>x*a+p));return r.jsxs("div",{className:"rv-root",children:[r.jsx("h1",{children:"⚫ Reversi"}),r.jsxs("div",{className:"rv-hud",children:[r.jsxs("span",{className:"rv-score-b",children:["⚫ ",M]}),r.jsx("span",{className:`rv-turn ${o===t?"your":"ai"}`,children:n?"Game Over":o===t?"Your turn":"AI thinking..."}),r.jsxs("span",{className:"rv-score-w",children:["⚪ ",A]})]}),r.jsx("div",{className:"rv-board",children:s.map((x,p)=>x.map((v,j)=>{const l=p*a+j,g=R.has(l),T=k.includes(l);return r.jsxs("div",{className:`rv-cell ${g?"valid":""}`,onClick:()=>h(p,j),children:[v!==C&&r.jsx("div",{className:`rv-piece ${v===t?"black":"white"} ${T?"flipped":""}`}),g&&v===C&&r.jsx("div",{className:"rv-hint"})]},l)}))}),n&&r.jsxs("div",{className:"rv-over",children:[r.jsx("h2",{children:M>A?"You Win! ⚫":M<A?"AI Wins! ⚪":"Draw!"}),r.jsxs("p",{children:["Black: ",M," — White: ",A]}),r.jsx("button",{onClick:f,children:"Play Again"})]}),r.jsx("button",{className:"rv-restart",onClick:f,children:"New Game"}),r.jsx(O,{})]})}export{Z as default};
